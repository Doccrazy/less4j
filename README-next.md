Less language is an extension of css and this project compiles it into regular css. It adds several dynamic features into css: variables, expressions, nested rules, and so on. Our [documentation](https://github.com/SomMeri/less4j/wiki) contains both overview of all these features and links to their detailed descriptions. If you are interested in the language itself, we recommend to start with the [overview](https://github.com/SomMeri/less4j/wiki/Supported-Less-Language).   

The original compiler was written in JavaScript and is called [less.js](http://lesscss.org/). Official less is mostly defined in less.js documentation/issues and by what less.js actually do. Links to less.js:
* [less.js home page](http://lesscss.org/) 
* [less.js source code & issues](https://github.com/cloudhead/less.js) 

Less4j is a port and its behavior should be as close to the original implementation as reasonable. Unless explicitly stated otherwise, any difference between less.js and less4j outputs is considered a bug. As close as reasonable means that style sheets generated by less4j must be functionally the same as the outputs of less.js. However, they do not have to be exactly the same:
* Behavior of less.js and less4j may differ on invalid input files.
* Output files may differ by whitespaces or comments locations.
* Less4j may do more than less.js in some situations. The input rejected by less.js may be accepted and translated by less4j. 

All known differences are documented on [wiki page](https://github.com/SomMeri/less4j/wiki/Differences-Between-Less.js-and-Less4j). Less4j also produces warnings any time it produces functionally different CSS.

## Continuous Integration
Continuous integration is set up on [Travis-CI](http://travis-ci.org/SomMeri/less4j), its current status is: [![Build Status](https://secure.travis-ci.org/SomMeri/less4j.png)](http://travis-ci.org/SomMeri/less4j).

## Twitter
Our twitter account: [Less4j](https://twitter.com/Less4j)

## Documentation:
The documentation is kept on Github wiki:
* [wiki home page](https://github.com/SomMeri/less4j/wiki),
* [all written wiki pages](https://github.com/SomMeri/less4j/wiki/_pages). 

For those interested about project internals, architecture and comments handling are described in a [blog post] (http://meri-stuff.blogspot.sk/2012/09/tackling-comments-in-antlr-compiler.html). The blog post captures our ideas at the time of its writing, so current implementation may be a bit different.

## Command Line
Less4j can run from [command line](https://github.com/SomMeri/less4j/wiki/Command-Line-Options). Latest versions are shared via [less4j dropbox account](https://www.dropbox.com/sh/zcb8p27db9ou4x1/keQWIZziH8). Shared folder always contains at least two latest versions, but we may remove older ones. 

If you need an old version for some reason, checkout appropriate tag from git and use `mvn package -P standalone` command. The command compiles less4j and all its dependencies into `target/less4j-<version>-shaded.jar` file. 

## Maven
Less4j is [available](http://search.maven.org/#browse|1893223923) in Maven central repository.

Pom.xml dependency:
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;com.github.sommeri&lt;/groupId&gt;
  &lt;artifactId&gt;less4j&lt;/artifactId&gt;
  &lt;version&gt;1.0.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

## Integration With Wro4j
The easiest way to integrate less4j into Java project is to use [wro4j](http://alexo.github.com/wro4j/) library. More about wro4j can be found either in a [blog post](http://meri-stuff.blogspot.sk/2012/08/wro4j-page-load-optimization-and-lessjs.html) or on wro4j [google code](http://code.google.com/p/wro4j/) page.

## API Basics:
Access the compiler either through the `com.github.less4j.LessCompiler` interface. The interface exposes multiple `compile` methods. Each takes file, url, string or other resource with less code and compiles it into css.

Thread safe implementation of `LessCompiler` interface is in `DefaultLessCompiler` class:
````java
public void example() throws Less4jException { 
  // create input file
  File inputLessFile = createFile("sampleInput.less", "* { margin: 1 1 1 1; }");

  // compile it
  LessCompiler compiler = new DefaultLessCompiler();
  CompilationResult compilationResult = compiler.compile(inputLessFile);

  // print results to console
  print(compilationResult)
}
````

Returned `CompilationResult` object has three methods: 
* `getCss` - compiled css,
* `getWarnings` - list of compilation warnings,
* `getSourceMap` - generated [source map](https://github.com/SomMeri/less4j/wiki/Command-Line-Options#source-map).

````java
private void print(CompilationResult compilationResult) {
  // print css
  System.out.println(compilationResult.getCss());
  // print source map
  System.out.println(compilationResult.getSourceMap());
  // print all warnings
  for (Problem warning : compilationResult.getWarnings()) {
    System.err.println(format(warning));
  }
}
````

Each Warning is described by a message and know source less file, line, character and column that caused it:
````java
private String format(Problem warning) {
  return "WARNING " + warning.getLine() +":" + warning.getCharacter()+ " " + warning.getMessage();
}
````

### Error Handling
The method may throw `Less4jException`. The exception is checked and can return list of all found compilation errors. In addition, some syntactically incorrect inputs may still lead to some output or produce a list of warnings. This output is most likely invalid and the list of warnings incomplete. The exception provides access to them anyway, because they can occasionally help with debugging. 

* `List<Problem> getErrors` - list of all found compilation errors.
* `CompilationResult getPartialResult()` -  css and list of warnings produced despite compilation errors. There is no guarantee on what exactly will be returned. Use with caution.  

Each problem or warning is described by a message. They also know source less file, line, character and column that caused them.  

### Compilation Options
The interface exposes following basic methods:
*  `CompilationResult compile(File inputFile)` - compiles a file, 
*  `CompilationResult compile(URL inputFile)` - compiles resource referenced through url/uri,
*  `CompilationResult compile(String lessContent)` - compiles a string - unable to import less files, leaves imports as they are,
*  `CompilationResult compile(LessSource inputFile)` - extend `LessSource` to add new resource type.

These methods differ in one important point: how they handle "@import lessFile" statement. In all cases, files referenced by the import statement are assumed to be relative to current file. They are also assumed to have the same type e.g., the first method assumes that all less files imports link files on local filesystem, second method assumes that all less imports reference files by relative urls and the third method leaves imports as they are.         

You can supply additional configuration options through optional `Configuration options` parameter. The `Configuration` class is still considered experimental and may change in the future.

*  `CompilationResult compile(File inputFile, Configuration options)`  
*  `CompilationResult compile(URL inputFile, Configuration options)` 
*  `CompilationResult compile(String lessContent, Configuration options)` 
*  `CompilationResult compile(LessSource inputFile, Configuration options)` 

## License
Less4j is distributed under following licences, pick whichever you like:
* [The Apache Software License, Version 2.0](http://www.apache.org/licenses/LICENSE-2.0.txt),
* [Eclipse Public License (EPL)](http://www.eclipse.org/legal/epl-v10.html),
* [Gnu General Public License, Version 3](http://www.gnu.org/licenses/gpl-3.0.html).

## Links:
*  [http://www.w3.org/Style/CSS/specs.en.html]
*  [http://www.w3.org/Style/CSS/Test/CSS3/Selectors/current/]
*  [http://www.w3.org/TR/css3-selectors/] 
*  [http://www.w3.org/wiki/CSS3/Selectors]
*  [http://www.w3.org/TR/CSS2/]
*  [http://www.w3.org/TR/CSS2/syndata.html#numbers]
*  [http://www.w3.org/TR/2012/WD-css3-fonts-20120823/]
*  [http://www.w3.org/TR/CSS21/fonts.html]
*  Comparison of less and sass: [https://gist.github.com/674726]


